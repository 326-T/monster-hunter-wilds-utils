import i18n from "i18next";
import { initReactI18next } from "react-i18next";

const LANGUAGE_STORAGE_KEY = "mhwu.language.v1";

const resources = {
	ja: {
		translation: {
			"app.title": "巨戟アーティア スキル抽選メモ",
			"tab.record": "記録する",
			"tab.verify": "確認する",
			"tab.advance": "進める",
			"language.ja": "日本語",
			"language.en": "English",
			"common.all": "すべて",
			"common.select": "選択してください",
			"common.open": "移動",
			"common.favorite": "お気に入り",
			"common.hiddenSkill": "非表示スキル",
			"common.unknown": "不明",
			"common.matches": "一致: {count} 件",
			"common.total": "全体: {count} 件",
			"common.visible": "表示: {count} 件",
			"common.noOptions": "選択肢がありません",
			"common.noEntries": "まだ記録がありません",
			"common.loadingOptions": "選択肢を読み込み中...",
			"save.tableList.title": "テーブル一覧",
			"save.tableList.description": "武器×属性のリンクから移動",
			"save.noTables": "該当するテーブルがありません",
			"save.record.title": "抽選結果を保存",
			"save.record.description": "テーブルごとに記録してお気に入りを管理",
			"save.selectedTable": "選択中のテーブル",
			"save.sections.header": "タイトルと使い方",
			"save.sections.select": "武器・属性を選択",
			"save.sections.register": "スキルを登録",
			"save.sections.results": "結果を確認",
			"save.entryTabs.manual": "手動登録",
			"save.entryTabs.ocr": "OCR登録",
			"save.cursorPosition": "カーソル位置: {value}",
			"save.entryCount": "記録数: {count}",
			"save.visibility.title": "表示スキル設定",
			"save.visibility.note": "非表示は「{label}」で記録",
			"save.seriesSkill": "シリーズスキル",
			"save.groupSkill": "グループスキル",
			"save.showAll": "すべて表示",
			"save.hideAll": "すべて非表示",
			"save.addEntry": "選択したスキルで結果を登録",
			"save.passedNote":
				"通過済みはデフォルト非表示。必要なら表示を切り替えます。",
			"save.showPassed": "通過済みを表示",
			"save.hidePassed": "通過済みを非表示",
			"save.ocr.title": "OCRで登録（実験）",
			"save.ocr.description":
				"ゲーム画面を読み取ってシリーズ/グループを自動登録します。",
			"save.ocr.startCamera": "カメラを起動",
			"save.ocr.stopCamera": "停止",
			"save.ocr.shutter": "シャッター",
			"save.ocr.cameraDevice": "カメラ選択",
			"save.ocr.cameraAuto": "自動",
			"save.ocr.cameraDeviceFallback": "カメラ {value}",
			"save.ocr.roiHelp": "ドラッグで読み取り範囲を指定してください。",
			"save.ocr.tableMissing": "テーブルを選択してください。",
			"save.ocr.noRoi": "読み取り範囲を指定してください。",
			"save.ocr.idle": "使用するカメラを選択して起動します。",
			"save.ocr.ready": "シャッターで読み取りできます。",
			"save.ocr.processing": "OCR 実行中...",
			"save.ocr.progress": "OCR 実行中... {value}%",
			"save.ocr.saved": "登録しました。",
			"save.ocr.failed": "OCR に失敗しました。",
			"save.ocr.cameraError": "カメラにアクセスできません。",
			"save.ocr.previewPlaceholder":
				"カメラを起動するとプレビューが表示されます。",
			"save.ocr.result": "読み取り結果",
			"save.ocr.resultNote": "間違いがあれば手動で修正してください。",
			"save.ocr.series": "シリーズ",
			"save.ocr.group": "グループ",
			"save.ocr.rawText": "OCR テキスト: {value}",
			"save.ocr.webgpuOn": "WebGPU: 有効",
			"save.ocr.webgpuOff": "WebGPU: 無効",
			"save.headers.series": "シリーズ",
			"save.headers.group": "グループ",
			"save.headers.favorite": "お気に入り",
			"save.headers.createdAt": "登録日時",
			"cursor.title": "テーブルを進める",
			"cursor.description":
				"スキル付与を行う武器/属性を選択してテーブルを進めます。現在のカーソル: {value}",
			"cursor.sections.header": "タイトルと使い方",
			"cursor.sections.filters": "武器・属性で絞り込む",
			"cursor.sections.candidates": "候補一覧",
			"cursor.candidates": "表示候補: {count} 件",
			"cursor.nullCount": "NULL: {count} 件",
			"cursor.noCandidates": "このカーソルで表示できる候補がありません",
			"cursor.addedAt": "登録: {value}",
			"cursor.advanceButton": "この結果でカーソルを進める",
			"cursor.advanceNote":
				"カーソルを進めると、NULL なテーブルはシリーズ/グループともに「{label}」で埋めます。",
			"verify.title": "確認",
			"verify.description": "保存済みの抽選結果を一覧で確認します。",
			"verify.sections.header": "タイトルと使い方",
			"verify.sections.transfer": "データの保存と復元",
			"verify.sections.filters": "絞り込み",
			"verify.sections.table": "登録済み一覧",
			"verify.export": "エクスポート",
			"verify.import": "インポート",
			"verify.importSuccess": "インポートしました。",
			"verify.importError": "インポートに失敗しました。",
			"verify.invalidFile": "不正なファイル形式です。",
			"verify.cursors": "カーソル数: {count} 件",
			"verify.columns": "列数: {count} 件",
			"verify.header.cursor": "カーソル",
			"verify.favorite.add": "お気に入りにする",
			"verify.favorite.remove": "お気に入りを外す",
			"filter.weapon": "武器",
			"filter.attribute": "属性",
			"error.loadOptions": "選択肢の読み込みに失敗しました。",
			"tour.start": "使い方",
			"tour.next": "次へ",
			"tour.back": "戻る",
			"tour.skip": "スキップ",
			"tour.close": "閉じる",
			"tour.last": "完了",
			"tour.save.select": "武器と属性を選んで、記録するテーブルを決めます。",
			"tour.save.current": "選択中のテーブルとカーソル位置を確認できます。",
			"tour.save.visibility":
				"表示するスキルを絞り込みたいときに使います。非表示は「非表示スキル」として記録されます。",
			"tour.save.form": "シリーズ/グループを選んで結果を追加します。",
			"tour.save.toggle": "通過済みの行は表示/非表示を切り替えられます。",
			"tour.save.table": "登録済みの行を編集・お気に入り設定できます。",
			"tour.cursor.filters": "武器/属性で候補を絞り込みます。",
			"tour.cursor.candidates": "このカーソルで取得できる候補が表示されます。",
			"tour.cursor.advance":
				"候補を選ぶとカーソルが進み、次の候補に更新されます。",
			"tour.verify.export":
				"エクスポート/インポートでデータを保存・復元します。",
			"tour.verify.filters": "武器/属性で確認対象を絞り込みます。",
			"tour.verify.table":
				"カーソルごとに結果が並び、セルを押すとお気に入りを切り替えます。",
		},
	},
	en: {
		translation: {
			"app.title": "Giant Halberd Artia Skill Draw Log",
			"tab.record": "Record",
			"tab.verify": "Review",
			"tab.advance": "Advance",
			"language.ja": "日本語",
			"language.en": "English",
			"common.all": "All",
			"common.select": "Select",
			"common.open": "Open",
			"common.favorite": "Favorite",
			"common.hiddenSkill": "Hidden Skill",
			"common.unknown": "Unknown",
			"common.matches": "Matches: {count}",
			"common.total": "Total: {count}",
			"common.visible": "Visible: {count}",
			"common.noOptions": "No options",
			"common.noEntries": "No entries yet",
			"common.loadingOptions": "Loading options...",
			"save.tableList.title": "Table List",
			"save.tableList.description": "Navigate by weapon and attribute",
			"save.noTables": "No matching tables",
			"save.record.title": "Save Draw Results",
			"save.record.description": "Record per table and manage favorites",
			"save.selectedTable": "Selected Table",
			"save.sections.header": "Title & Tour",
			"save.sections.select": "Select Weapon / Attribute",
			"save.sections.register": "Register Skills",
			"save.sections.results": "Review Results",
			"save.entryTabs.manual": "Manual",
			"save.entryTabs.ocr": "OCR",
			"save.cursorPosition": "Cursor: {value}",
			"save.entryCount": "Entries: {count}",
			"save.visibility.title": "Visible Skills",
			"save.visibility.note": 'Hidden items are recorded as "{label}"',
			"save.seriesSkill": "Series Skill",
			"save.groupSkill": "Group Skill",
			"save.showAll": "Show all",
			"save.hideAll": "Hide all",
			"save.addEntry": "Save with selected skills",
			"save.passedNote":
				"Passed entries are hidden by default. Toggle to show them.",
			"save.showPassed": "Show passed",
			"save.hidePassed": "Hide passed",
			"save.ocr.title": "OCR Capture (Experimental)",
			"save.ocr.description":
				"Read the game screen and auto-register series/group skills.",
			"save.ocr.startCamera": "Start camera",
			"save.ocr.stopCamera": "Stop",
			"save.ocr.shutter": "Shutter",
			"save.ocr.cameraDevice": "Camera",
			"save.ocr.cameraAuto": "Auto",
			"save.ocr.cameraDeviceFallback": "Camera {value}",
			"save.ocr.roiHelp": "Drag to select the reading area.",
			"save.ocr.tableMissing": "Select a table first.",
			"save.ocr.noRoi": "Select a reading area first.",
			"save.ocr.idle": "Select a camera and start it.",
			"save.ocr.ready": "Ready to capture.",
			"save.ocr.processing": "Running OCR...",
			"save.ocr.progress": "Running OCR... {value}%",
			"save.ocr.saved": "Saved.",
			"save.ocr.failed": "OCR failed.",
			"save.ocr.cameraError": "Camera access failed.",
			"save.ocr.previewPlaceholder": "Camera preview will appear here.",
			"save.ocr.result": "OCR result",
			"save.ocr.resultNote": "If anything looks wrong, adjust it manually.",
			"save.ocr.series": "Series",
			"save.ocr.group": "Group",
			"save.ocr.rawText": "OCR text: {value}",
			"save.ocr.webgpuOn": "WebGPU: On",
			"save.ocr.webgpuOff": "WebGPU: Off",
			"save.headers.series": "Series",
			"save.headers.group": "Group",
			"save.headers.favorite": "Favorite",
			"save.headers.createdAt": "Created",
			"cursor.title": "Advance Table",
			"cursor.description":
				"Select the weapon/attribute to apply skills and advance the table. Current cursor: {value}",
			"cursor.sections.header": "Title & Tour",
			"cursor.sections.filters": "Filter by Weapon / Attribute",
			"cursor.sections.candidates": "Candidate List",
			"cursor.candidates": "Candidates: {count}",
			"cursor.nullCount": "NULL: {count}",
			"cursor.noCandidates": "No candidates for this cursor.",
			"cursor.addedAt": "Added: {value}",
			"cursor.advanceButton": "Advance with this result",
			"cursor.advanceNote":
				'When advancing, NULL tables are filled with "{label}" for both series and group.',
			"verify.title": "Review",
			"verify.description": "Review saved draw results.",
			"verify.sections.header": "Title & Tour",
			"verify.sections.transfer": "Backup & Restore",
			"verify.sections.filters": "Filters",
			"verify.sections.table": "Saved Results",
			"verify.export": "Export",
			"verify.import": "Import",
			"verify.importSuccess": "Imported.",
			"verify.importError": "Import failed.",
			"verify.invalidFile": "Invalid file format.",
			"verify.cursors": "Cursors: {count}",
			"verify.columns": "Columns: {count}",
			"verify.header.cursor": "Cursor",
			"verify.favorite.add": "Add favorite",
			"verify.favorite.remove": "Remove favorite",
			"filter.weapon": "Weapon",
			"filter.attribute": "Attribute",
			"error.loadOptions": "Failed to load options.",
			"tour.start": "How to use",
			"tour.next": "Next",
			"tour.back": "Back",
			"tour.skip": "Skip",
			"tour.close": "Close",
			"tour.last": "Done",
			"tour.save.select": "Choose a weapon and attribute to select the table.",
			"tour.save.current": "Review the current table and cursor position.",
			"tour.save.visibility":
				'Use this to filter visible skills. Hidden entries are recorded as "Hidden Skill."',
			"tour.save.form": "Pick series/group skills and add a new entry.",
			"tour.save.toggle": "Toggle whether passed rows are shown.",
			"tour.save.table": "Edit saved rows and toggle favorites.",
			"tour.cursor.filters": "Filter candidates by weapon and attribute.",
			"tour.cursor.candidates":
				"Candidates available for the current cursor appear here.",
			"tour.cursor.advance": "Choosing a result advances the cursor.",
			"tour.verify.export": "Export/import lets you back up and restore data.",
			"tour.verify.filters": "Filter the table by weapon and attribute.",
			"tour.verify.table":
				"Rows are grouped by cursor. Click a cell to toggle favorite.",
		},
	},
};

const resolveInitialLanguage = () => {
	if (typeof window === "undefined") return "ja";
	const stored = window.localStorage.getItem(LANGUAGE_STORAGE_KEY);
	return stored === "en" ? "en" : "ja";
};

i18n.use(initReactI18next).init({
	resources,
	lng: resolveInitialLanguage(),
	fallbackLng: "ja",
	interpolation: {
		escapeValue: false,
		prefix: "{",
		suffix: "}",
	},
});

if (typeof window !== "undefined") {
	i18n.on("languageChanged", (lng) => {
		window.localStorage.setItem(LANGUAGE_STORAGE_KEY, lng);
		document.documentElement.lang = lng;
	});
	document.documentElement.lang = i18n.language;
}

export default i18n;
